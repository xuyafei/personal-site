---
title: "C++è®¿é—®æ§åˆ¶è¯¦è§£"
date: 2025-05-27
draft: false
description: "æ·±å…¥è§£æC++è®¿é—®æ§åˆ¶æœºåˆ¶ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§åº”ç”¨ï¼Œä»åŸç†åˆ°å®è·µ"
tags: ["C++", "é¢å‘å¯¹è±¡", "è®¿é—®æ§åˆ¶", "å°è£…", "ç»§æ‰¿"]
categories: ["ç¼–ç¨‹è¯­è¨€"]
author: "å¾äºšé£"
showToc: true
TocOpen: true
weight: 19
math: true
---

# C++è®¿é—®æ§åˆ¶è¯¦è§£

## ä¸€ã€åŸºæœ¬æ¦‚å¿µ

### 1. è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦

C++ ä¸­çš„ç±»æˆå‘˜é»˜è®¤æ˜¯ privateï¼Œç»“æ„ä½“æˆå‘˜é»˜è®¤æ˜¯ publicã€‚

ä¸‰ç§è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼š

| ä¿®é¥°ç¬¦ | ç±»å†…è®¿é—® | æ´¾ç”Ÿç±»è®¿é—® | ç±»å¤–è®¿é—® |
|--------|----------|------------|----------|
| public | âœ… | âœ… | âœ… |
| protected | âœ… | âœ… | âŒ |
| private | âœ… | âŒ | âŒ |

### 2. è®¿é—®æ§åˆ¶ä¸ç»§æ‰¿

æ´¾ç”Ÿç±»æ˜¯å¦å¯ä»¥è®¿é—®åŸºç±»çš„æˆå‘˜ï¼Œè¿˜å—åˆ°**ç»§æ‰¿æ–¹å¼ï¼ˆpublic/protected/privateï¼‰**çš„å½±å“ã€‚

| ç»§æ‰¿æ–¹å¼ | åŸºç±» public æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸º | åŸºç±» protected æˆå‘˜å˜ä¸º | åŸºç±» private æˆå‘˜å˜ä¸º |
|----------|-------------------------------|------------------------|----------------------|
| public | public | protected | ä¸å¯è®¿é—® |
| protected | protected | protected | ä¸å¯è®¿é—® |
| private | private | private | ä¸å¯è®¿é—® |

ç¤ºä¾‹ï¼š
```cpp
class Base {
public:    int a;
protected: int b;
private:   int c;
};

class Derived1 : public Base {
    // a æ˜¯ publicï¼Œb æ˜¯ protectedï¼Œc æ— æ³•è®¿é—®
};

class Derived2 : protected Base {
    // a å’Œ b éƒ½å˜ä¸º protectedï¼Œc æ— æ³•è®¿é—®
};

class Derived3 : private Base {
    // a å’Œ b éƒ½å˜ä¸º privateï¼Œc æ— æ³•è®¿é—®
};
```

## äºŒã€è®¿é—®æ§åˆ¶è¯¦è§£

### 1. public å…¬æœ‰æˆå‘˜

#### ç‰¹ç‚¹
- è¡¨ç¤ºè¿™ä¸ªæˆå‘˜å¯¹æ‰€æœ‰äººéƒ½å¯è§ï¼šç±»è‡ªèº«ã€æ´¾ç”Ÿç±»ã€å¤–éƒ¨ä»£ç 
- å¸¸ç”¨äºç±»çš„æ¥å£å‡½æ•°ï¼ˆå¦‚ getX()ã€setX()ï¼‰ï¼Œæ˜¯å¯¹å¤–çš„"å…¬å…±å…¥å£"

#### åº”ç”¨åœºæ™¯
1. æ¥å£ç±»ä¸­çš„å‡½æ•°ï¼š
```cpp
class Animal {
public:
    virtual void speak() = 0; // å…¬å…±æ¥å£
};
```

2. ç”¨æˆ·è°ƒç”¨æ–¹æ³•æˆ–è®¿é—®æ•°æ®æ—¶ï¼š
```cpp
obj.print();
```

### 2. protected å—ä¿æŠ¤æˆå‘˜

#### åŸºæœ¬å®šä¹‰
protected æˆå‘˜åªèƒ½è¢«ï¼š
- å½“å‰ç±»è®¿é—®
- å…¶æ´¾ç”Ÿç±»è®¿é—®
- ç±»å¤–æ— æ³•è®¿é—®

å®ƒä»‹äº privateï¼ˆæ›´å°é—­ï¼‰å’Œ publicï¼ˆå®Œå…¨å¼€æ”¾ï¼‰ä¹‹é—´ã€‚

#### è®¿é—®æƒé™è¯¦è§£

1. protected æˆå‘˜çš„è®¿é—®æƒé™å¦‚ä¸‹ï¼š

| è®¿é—®è€… | private | protected | public |
|--------|---------|-----------|--------|
| æœ¬ç±» | âœ… | âœ… | âœ… |
| å­ç±» | âŒ | âœ… | âœ… |
| å¤–éƒ¨ç±»æˆ–å¯¹è±¡ | âŒ | âŒ | âœ… |

æ‰€ä»¥ protected æˆå‘˜ï¼š
- âœ… å­ç±»å¯ä»¥è®¿é—®
- âŒ å¤–éƒ¨ä¸èƒ½è®¿é—®ï¼ˆåŒ…æ‹¬ main å‡½æ•°ã€åˆ«çš„ç±»ã€ç”¨æˆ·ä»£ç ï¼‰
- âœ… æœ¬ç±»è‡ªç„¶å¯ä»¥è®¿é—®

#### ä½¿ç”¨åœºæ™¯

1. è®©å­ç±»å¤ç”¨çˆ¶ç±»å®ç°ï¼ˆä½†ä¸æš´éœ²ç»™å¤–éƒ¨ï¼‰ï¼š
```cpp
class Base {
protected:
    int internalCounter = 0;

public:
    void reset() { internalCounter = 0; }
};

class Derived : public Base {
public:
    void increment() { internalCounter++; }  // å¯ä»¥è®¿é—®
};
```

2. åœ¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­ä¿æŠ¤åŸºç¡€é€»è¾‘ï¼š
```cpp
class Game {
public:
    void run() {
        init();    // å›ºå®šçš„åˆå§‹åŒ–æµç¨‹
        play();    // ç•™ç»™å­ç±»å†³å®šæ€ä¹ˆå®ç°
        cleanup(); // å›ºå®šçš„æ”¶å°¾æµç¨‹
    }

protected:
    virtual void init() { std::cout << "Base init\n"; }
    virtual void play() = 0;
    virtual void cleanup() { std::cout << "Base cleanup\n"; }
};

class Chess : public Game {
protected:
    void play() override {
        std::cout << "Playing chess\n";
        // init(); // âœ… å¯ä»¥å†™ï¼Œä½†è®¾è®¡ä¸Šä¸æ¨èè¿™ä¹ˆåš
    }
};
```

#### å—æ§å¼€æ”¾ï¼ˆControlled Extensibilityï¼‰

"å­ç±»å†…éƒ¨å¯ä»¥è®¿é—® init()ï¼Œä¸ºä»€ä¹ˆè¯´ä¸èƒ½è°ƒç”¨ï¼Ÿ"

âœ… ç­”æ¡ˆæ˜¯ï¼šè¯­æ³•ä¸Šå¯ä»¥è°ƒç”¨ï¼Œä½†è®¾è®¡ä¸Š"ä¸å»ºè®®"è°ƒç”¨

è¿™æ­£æ˜¯é¢å‘å¯¹è±¡è®¾è®¡ä¸­çš„ä¸€ä¸ªé‡è¦æ€æƒ³ï¼š"å—æ§å¼€æ”¾ï¼ˆControlled Extensibilityï¼‰"ã€‚

ğŸš§ ä¸ºä»€ä¹ˆè¯´æ˜¯"å—æ§å¼€æ”¾"ï¼Ÿ
- run() æ˜¯çˆ¶ç±»æ§åˆ¶çš„æµç¨‹ï¼Œçˆ¶ç±»è´Ÿè´£"ä½•æ—¶"è°ƒç”¨ init()
- è™½ç„¶å­ç±»å¯ä»¥è®¿é—® init()ï¼ˆå› ä¸ºæ˜¯ protectedï¼‰ï¼Œä½†å­ç±»ä¸åº”è¯¥æ”¹å˜æµç¨‹çš„è°ƒç”¨æ—¶æœºï¼Œå¦åˆ™å°±æ‰“ç ´äº†æ¡†æ¶è®¾è®¡çš„å°è£…æ€§

ğŸ§  ä¸¾ä¸ªç°å®ä¾‹å­ç†è§£ï¼š

ä½ æœ‰ä¸€ä¸ªç”µé¥­é”…ï¼ˆçˆ¶ç±»ï¼‰ï¼Œå†…éƒ¨æµç¨‹æ˜¯ï¼š
1. åŠ çƒ­ï¼ˆinitï¼‰
2. è’¸ç…®ï¼ˆplayï¼‰
3. ä¿æ¸©ï¼ˆcleanupï¼‰

ä½ ç»§æ‰¿å®ƒåšäº†ä¸€ä¸ª"æ™ºèƒ½ç”µé¥­é”…"ï¼ˆå­ç±»ï¼‰â€”â€”ä½ å¯ä»¥é‡å†™"è’¸ç…®"çš„é€»è¾‘ï¼Œä½†ä½ ä¸èƒ½æ’æ‰‹ä½•æ—¶å¼€å§‹åŠ çƒ­ã€ä¿æ¸©ã€‚

å¦‚æœä½ åœ¨ play() é‡Œé¢åˆè°ƒç”¨ä¸€æ¬¡ init()ï¼Œä½ å…¶å®åœ¨"å·å·é‡æ–°åŠ çƒ­"ï¼Œç ´åäº†æµç¨‹ï¼Œç»“æœå¯èƒ½"ç…®åé¥­"ã€‚

âœ… æ€»ç»“ä½ çš„ç–‘é—®ï¼š
| é—®é¢˜ | å›ç­” |
|------|------|
| å­ç±»èƒ½ä¸èƒ½è°ƒç”¨ init()ï¼Ÿ | âœ… è¯­æ³•ä¸Šå¯ä»¥è°ƒç”¨ï¼Œå› ä¸ºæ˜¯ protectedï¼Œå¯¹å­ç±»å¯è§ |
| ä¸ºä»€ä¹ˆè¯´"å­ç±»ä¸èƒ½è°ƒç”¨ init()"ï¼Ÿ | âŒ ä¸æ˜¯è¯­æ³•é™åˆ¶ï¼Œè€Œæ˜¯è®¾è®¡ä¸Šçš„çº¦æŸï¼Œé¿å…å­ç±»ç ´åçˆ¶ç±»è®¾è®¡å¥½çš„æµç¨‹ |
| è°èƒ½è°ƒç”¨ init()ï¼Ÿ | Game ç±»è‡ªå·±å¯ä»¥ï¼ŒChess å­ç±»ä¹Ÿå¯ä»¥â€”â€”ä½†è®¾è®¡ä¸Šåªå…è®¸ run() æ§åˆ¶å®ƒ |
| ä»€ä¹ˆæ˜¯"å—æ§å¼€æ”¾"ï¼Ÿ | çˆ¶ç±»å…è®¸å­ç±»æ‰©å±•éƒ¨åˆ†è¡Œä¸ºï¼ˆå¦‚ play()ï¼‰ï¼Œä½†ä¿ç•™æµç¨‹æ§åˆ¶æƒï¼ˆå¦‚ init()ï¼‰ |

ğŸ” å¦‚æœä½ ç¡¬è¦è®© init() ä¸èƒ½è¢«å­ç±»è°ƒç”¨ï¼Ÿ
é‚£å°±æŠŠå®ƒè®¾ä¸º privateï¼Œä½†è¿™æ ·å­ç±»è¿ override éƒ½åšä¸äº†ï¼Œè¿™å°±ç‰ºç‰²äº†çµæ´»æ€§ã€‚å› æ­¤æˆ‘ä»¬ç”¨ protectedï¼Œæ˜¯ä¸€ç§å¯¹å­ç±»å¼€æ”¾ã€ä½†çº¦å®šä¿—æˆè¦éµå®ˆä½¿ç”¨è¾¹ç•Œçš„æ–¹å¼ã€‚

è¿™ç§è®¾è®¡æ¨¡å¼ï¼ˆç§°ä¸ºæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼‰æ­£å¥½æ˜¯é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§â€”â€”å°è£…ã€ç»§æ‰¿ã€å¤šæ€çš„ç»å…¸åº”ç”¨ä½“ç°ä¹‹ä¸€ã€‚ä¸‹é¢æˆ‘ä»¬æ¥æ·±å…¥è®²æ¸…æ¥šè¿™ä¸ªè®¾è®¡æ¨¡å¼ï¼Œå¹¶ç»“åˆ OOP ä¸‰å¤§ç‰¹æ€§é€æ­¥è§£æï¼š

ğŸ¯ ä¸€ã€ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Ÿ

æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®šä¹‰ï¼š
åœ¨åŸºç±»ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼ˆå›ºå®šçš„æ‰§è¡Œæµç¨‹ï¼‰ï¼Œè€Œå°†æŸäº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­å®ç°ã€‚
åŸºç±»æ§åˆ¶æ•´ä½“æµç¨‹ï¼Œå­ç±»è´Ÿè´£å®ç°ç»†èŠ‚ï¼Œæµç¨‹ä¸å¯æ›´æ”¹ï¼Œç»†èŠ‚å¯æ‰©å±•ã€‚

ğŸ”§ äºŒã€ç»“æ„åŸå‹ä»£ç ï¼ˆç»å…¸æ¡ˆä¾‹ï¼‰

```cpp
class Game {
public:
    void run() {
        init();       // ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–
        play();       // ç¬¬äºŒæ­¥ï¼šè¿›è¡Œæ¸¸æˆï¼ˆå»¶è¿Ÿåˆ°å­ç±»ï¼‰
        cleanup();    // ç¬¬ä¸‰æ­¥ï¼šæ¸…ç†èµ„æº
    }

protected:
    virtual void init()    { std::cout << "Game init\n"; }
    virtual void play() = 0;  // æŠ½è±¡æ–¹æ³•ï¼Œå¼ºåˆ¶å­ç±»å®ç°
    virtual void cleanup() { std::cout << "Game cleanup\n"; }
};

class ChessGame : public Game {
protected:
    void play() override {
        std::cout << "Playing Chess\n";
    }
};

// ä½¿ç”¨ï¼š
int main() {
    Game* g = new ChessGame();
    g->run(); // åªæš´éœ²ä¸€ä¸ª run()ï¼Œè°ƒç”¨æµç¨‹ç”±çˆ¶ç±»æ§åˆ¶
    delete g;
}
```

ğŸ§± ä¸‰ã€å’Œ OOP ä¸‰å¤§ç‰¹æ€§å…³ç³»è¯¦è§£

1. âœ… å°è£…ï¼ˆEncapsulationï¼‰
   - å°è£…çš„æ˜¯**"æ•´ä½“æµç¨‹"**ï¼Œä¸å…è®¸å¤–éƒ¨å’Œå­ç±»å¹²æ‰° run() æ–¹æ³•ä¸­å›ºå®šçš„æ‰§è¡Œé¡ºåº
   - init()ã€cleanup() ç”šè‡³ run() éƒ½å¯ä»¥è®¾ç½®ä¸º protected / privateï¼Œæš´éœ²æœ€å°çš„æ¥å£ï¼ˆå¦‚ run() ä¸º publicï¼Œå…¶ä½™ä¸º protectedï¼‰ï¼Œéšè—å®ç°ç»†èŠ‚ã€å¯¹å¤–æš´éœ²ç»Ÿä¸€å…¥å£

ğŸŸ© å°è£…ä½“ç°ï¼š
   - å¯¹å¤–åªæš´éœ² run()
   - å†…éƒ¨æ€ä¹ˆåˆå§‹åŒ–å’Œæ¸…ç†ï¼Œå¤–éƒ¨æ— æƒå¹²æ¶‰

2. âœ… ç»§æ‰¿ï¼ˆInheritanceï¼‰
   - å­ç±»ç»§æ‰¿çˆ¶ç±» Game
   - åˆ©ç”¨ç»§æ‰¿æ¥æ‰©å±•å…·ä½“çš„ play() å®ç°ï¼Œæ”¯æŒå¤šç§ä¸åŒç©æ³•ï¼Œå¦‚ ChessGameã€FootballGame ç­‰

ğŸŸ© ç»§æ‰¿ä½“ç°ï¼š
   - å¤ç”¨çˆ¶ç±»ä»£ç ç»“æ„
   - å­ç±»æ‰©å±•å®šåˆ¶åŒ–é€»è¾‘

3. âœ… å¤šæ€ï¼ˆPolymorphismï¼‰
   - play() æ˜¯ virtual çš„ï¼ˆç”šè‡³çº¯è™šå‡½æ•°ï¼‰ï¼Œçˆ¶ç±»æŒ‡é’ˆ Game* å¯ä»¥æŒ‡å‘ä»»ä½•å…·ä½“å­ç±»
   - è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡ç±»å‹åŠ¨æ€è°ƒç”¨ play()ï¼Œè¾¾åˆ°å¤šæ€æ•ˆæœ

ğŸŸ© å¤šæ€ä½“ç°ï¼š
   - Game* g = new ChessGame();
   - è°ƒç”¨ g->run() æ—¶ï¼Œå†…éƒ¨å®é™…è°ƒç”¨çš„æ˜¯å­ç±» ChessGame çš„ play() å®ç°

ğŸ“¦ å››ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ä¼˜ç‚¹æ€»ç»“

| ä¼˜ç‚¹ | è§£é‡Š |
|------|------|
| âœ… ç»Ÿä¸€æµç¨‹æ§åˆ¶ | çˆ¶ç±»å°è£…æ•´ä¸ªç®—æ³•ç»“æ„ï¼Œå­ç±»ä¸èƒ½ä¹±æ”¹é¡ºåºï¼Œç¡®ä¿æµç¨‹ä¸€è‡´æ€§ |
| âœ… æ‰©å±•çµæ´» | å­ç±»å¯ä»¥è‡ªç”±å®šåˆ¶ play() çš„ç»†èŠ‚ |
| âœ… é¿å…é‡å¤ä»£ç  | å…¬å…±çš„ init() å’Œ cleanup() ç”±çˆ¶ç±»ç»Ÿä¸€å®ç° |
| âœ… æ”¯æŒå¼€é—­åŸåˆ™ | æ·»åŠ æ–°ç©æ³•åªéœ€æ–°å»ºå­ç±»ï¼Œä¸åŠ¨åŸæœ‰çˆ¶ç±»ä»£ç  |

ğŸ§  äº”ã€ç±»æ¯”ç°å®ä¸–ç•Œå¸®åŠ©ç†è§£

æƒ³è±¡ä¸€ä¸ª"ç‚¹å¤–å–"çš„æµç¨‹ï¼ˆçˆ¶ç±»æ§åˆ¶ï¼‰ï¼š
```cpp
class OrderFood {
public:
    void order() {
        selectRestaurant();
        chooseFood();      // ä¸åŒäººç‚¹çš„èœä¸åŒ
        pay();
    }

protected:
    void selectRestaurant() { std::cout << "Choose restaurant\n"; }
    virtual void chooseFood() = 0;
    void pay() { std::cout << "Pay for food\n"; }
};

// ä¸åŒäººç»§æ‰¿è¿™ä¸ªæµç¨‹å®šåˆ¶ chooseFood()ï¼š
class AliceOrder : public OrderFood {
    void chooseFood() override { std::cout << "Alice orders sushi\n"; }
};

class BobOrder : public OrderFood {
    void chooseFood() override { std::cout << "Bob orders burger\n"; }
};
```

ä½ åªç®¡è°ƒç”¨ order()ï¼Œç‚¹é¤æµç¨‹å°±å…¨è·‘å®Œäº†ï¼Œå¤–éƒ¨ä¸éœ€è¦çŸ¥é“ç»†èŠ‚ï¼Œè¿™å°±å«æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é­…åŠ›ã€‚

ğŸ§­ å…­ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼åº”ç”¨åœºæ™¯
- æ¸¸æˆå¼€å‘ï¼šé€šç”¨æµç¨‹ï¼Œæ‰©å±•ç©æ³•
- ç½‘ç»œè¯·æ±‚ï¼šæ¨¡æ¿å°è£…è¯·æ±‚æµç¨‹ã€å›è°ƒå­ç±»å¤„ç†å“åº”
- æ¡†æ¶è®¾è®¡ï¼šå¦‚ Qtã€Java çš„ GUI æ¡†æ¶ä¸­ paintEvent() å°±æ˜¯å…¸å‹çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼

ğŸ”š æ€»ç»“ä¸€å¼ è¡¨ï¼šOOP ç‰¹æ€§å¦‚ä½•åœ¨æ¨¡æ¿æ–¹æ³•ä¸­ä½“ç°

| ç‰¹æ€§ | æ¨¡æ¿æ–¹æ³•ä¸­çš„ä½“ç° |
|------|-----------------|
| å°è£… | run() å°è£…æ•´ä½“æµç¨‹ï¼Œå¯¹å¤–éšè—ç»†èŠ‚ |
| ç»§æ‰¿ | å­ç±»ç»§æ‰¿çˆ¶ç±»ç»“æ„ï¼Œè‡ªå®šä¹‰éƒ¨åˆ†é€»è¾‘ |
| å¤šæ€ | å­ç±»å®ç°è™šå‡½æ•°ï¼Œè¿è¡Œæ—¶åŠ¨æ€å†³å®šè°ƒç”¨å“ªä¸€ç‰ˆ |

3. é¿å…"æœ‹å‹å¤–äºº"ä¹±æ”¹çŠ¶æ€ï¼š
```cpp
class BankAccount {
protected:
    double balance;

public:
    BankAccount(double initial) : balance(initial) {}
    virtual void deposit(double amount) { balance += amount; }
};

class PremiumAccount : public BankAccount {
public:
    PremiumAccount(double initial) : BankAccount(initial) {}
    void bonusInterest() { balance += balance * 0.05; }  // è®¿é—®å—ä¿æŠ¤çš„ balance
};
```

### 3. private ç§æœ‰æˆå‘˜

#### ç‰¹ç‚¹
- è¡¨ç¤ºæˆå‘˜åªèƒ½è¢«å½“å‰ç±»è®¿é—®ï¼Œå¤–éƒ¨å’Œæ´¾ç”Ÿç±»éƒ½ä¸èƒ½è®¿é—®
- æ˜¯æœ€ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶ï¼Œé€šå¸¸ç”¨äºä¿æŠ¤å†…éƒ¨æ•°æ®ï¼Œé˜²æ­¢è¯¯ç”¨

#### åº”ç”¨åœºæ™¯
1. æˆå‘˜å˜é‡å‡ ä¹æ€»æ˜¯è®¾ä¸º privateï¼Œä»¥å®ç°å°è£…ï¼š
```cpp
class User {
private:
    std::string password;

public:
    void setPassword(const std::string& pwd);
};
```

2. é˜»æ­¢æ´¾ç”Ÿç±»è®¿é—®å†…éƒ¨å®ç°ç»†èŠ‚ï¼š
```cpp
class Connection {
private:
    void openSocket(); // å¤–éƒ¨å’Œå­ç±»éƒ½ä¸èƒ½è°ƒç”¨
};
```

## ä¸‰ã€å‹å…ƒæœºåˆ¶

### 1. åŸºæœ¬æ¦‚å¿µ

C++ ä¸­å¯ä»¥é€šè¿‡ friend å£°æ˜ï¼Œä½¿æŸäº›å‡½æ•°æˆ–ç±»å¯ä»¥è®¿é—®å¦ä¸€ä¸ªç±»çš„ç§æœ‰/å—ä¿æŠ¤æˆå‘˜ã€‚

```cpp
class A {
private:
    int secret = 42;

    friend void reveal(A&);
};

void reveal(A& a) {
    std::cout << a.secret << std::endl;  // åˆæ³•
}
```

### 2. åº”ç”¨åœºæ™¯

#### 1. æ“ä½œç¬¦é‡è½½ï¼ˆéæˆå‘˜ï¼‰
```cpp
class Vector {
private:
    int x, y;

public:
    Vector(int x, int y) : x(x), y(y) {}

    friend Vector operator+(const Vector& a, const Vector& b);
};

Vector operator+(const Vector& a, const Vector& b) {
    return Vector(a.x + b.x, a.y + b.y);  // å¯ä»¥è®¿é—® private æˆå‘˜
}
```

#### 2. è¾…åŠ©ç±»ï¼ˆBuilderã€Iteratorï¼‰è®¿é—®å†…éƒ¨çŠ¶æ€
```cpp
class House;

class HouseBuilder {
public:
    House create();
};

class House {
private:
    std::string wallType;
    int windows;

    friend class HouseBuilder;
};
```

### 3. å‹å…ƒçš„æ³¨æ„ç‚¹

| ç‰¹ç‚¹ | è¯´æ˜ |
|------|------|
| ä¸å—ç»§æ‰¿é™åˆ¶ | friend ä¸ä¼šè¢«ç»§æ‰¿ç»™å­ç±» |
| å•å‘å…³ç³» | A æ˜¯ B çš„ friendï¼Œä¸ä»£è¡¨ B æ˜¯ A çš„ friend |
| ä¼šç ´åå°è£… | æ»¥ç”¨ä¼šå¯¼è‡´ç±»ä¹‹é—´é«˜åº¦è€¦åˆï¼Œå¤±å»æ¨¡å—è¾¹ç•Œ |

### 4. friend vs protected åŒºåˆ«

| ç‰¹æ€§ | protected | friend |
|------|-----------|--------|
| å¯è®¿é—®æƒé™ | ç±»å’Œå­ç±» | è¢«æˆæƒçš„ç±»/å‡½æ•° |
| æ˜¯å¦ç»§æ‰¿å¯è§ | âœ… | âŒ |
| æ˜¯å¦ç ´åå°è£… | å¦ï¼ˆè¾ƒå¼±ï¼‰ | æ˜¯ï¼ˆè¾ƒå¼ºï¼‰ |
| ä½¿ç”¨å…¸å‹åœºæ™¯ | ç»§æ‰¿è®¾è®¡ / æ¨¡æ¿æ–¹æ³• / æŠ½è±¡ç±» | æ“ä½œç¬¦é‡è½½ / è¾…åŠ©ç±» / é«˜æ•ˆåä½œç±»è®¾è®¡ |

## å››ã€è®¾è®¡å»ºè®®ä¸æœ€ä½³å®è·µ

### 1. è®¿é—®æ§åˆ¶çš„è®¾è®¡å»ºè®®

| ç±»æˆå‘˜ | å»ºè®®ä½¿ç”¨çš„è®¿é—®æ§åˆ¶ | åŸå›  |
|--------|-------------------|------|
| æˆå‘˜å˜é‡ | privateï¼ˆæˆ– protectedï¼‰ | å°è£…ã€æ§åˆ¶è®¿é—® |
| å…¬å…± API æ¥å£ | public | æš´éœ²å¤–éƒ¨æ¥å£ |
| è¾…åŠ©å‡½æ•° | private | ä»…é™ç±»å†…éƒ¨è°ƒç”¨ |
| å¯è¢«å­ç±»é‡ç”¨çš„åŸºç¡€åŠŸèƒ½ | protected | å­ç±»å…±äº«ä½†ä¸å¯¹å¤–æš´éœ² |

### 2. å¸¸è§è®¾è®¡é™·é˜±ä¸è¯¯åŒº

1. è¯¯å°†æ•°æ®æˆå‘˜è®¾ä¸º public
   - ä¼šç ´åå°è£…æ€§ï¼Œä½¿å¯¹è±¡æ•°æ®æš´éœ²åœ¨å¤–éƒ¨ï¼Œæ˜“äºå‡ºé”™
   - æ”¹è¿›æ–¹æ³•ï¼šä½¿ç”¨ getter/setter

2. å°†æ‰€æœ‰å‡½æ•°è®¾ä¸º public
   - ä¼šæš´éœ²å¤ªå¤šæ— å…³å†…éƒ¨é€»è¾‘ï¼Œå¯¼è‡´æ¥å£å¤æ‚ã€éš¾ç»´æŠ¤

3. æ»¥ç”¨ protected
   - åªæœ‰å½“ä½ ç¡®ä¿¡å­ç±»éœ€è¦è®¿é—®æ—¶æ‰ä½¿ç”¨ï¼Œå¦åˆ™å°±åº”å½“ private

### 3. å®æˆ˜å»ºè®®

#### ä»€ä¹ˆæ—¶å€™ç”¨ protectedï¼Ÿ
- ä½ å¸Œæœ›å­ç±»æ‰©å±•/æ§åˆ¶è¡Œä¸ºï¼Œä½†åˆä¸å¸Œæœ›å¤–éƒ¨ä½¿ç”¨
- æ¯”å¦‚çŠ¶æ€ã€æ¨¡æ¿æ–¹æ³•çš„æ­¥éª¤ã€å—ä¿æŠ¤å·¥å…·å‡½æ•°ç­‰

#### ä»€ä¹ˆæ—¶å€™ç”¨ friendï¼Ÿ
- å‡½æ•°éœ€è¦è·¨ç±»è®¿é—®ç§æœ‰æ•°æ®ï¼Œä½†ä¸å¸Œæœ›æ”¹å˜æ•°æ®çš„æ‰€æœ‰è€…
- æ¯”å¦‚åŒå‘å…³è”ç±»ã€æ“ä½œç¬¦é‡è½½ã€æ„å»ºå™¨ç±»ã€è°ƒè¯•å·¥å…·ç­‰

## äº”ã€æ€»ç»“

### æ ¸å¿ƒæ¦‚å¿µå›é¡¾
- privateï¼šæœ€ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶ï¼Œä»…ç±»å†…å¯è®¿é—®
- protectedï¼šç±»å†…å’Œæ´¾ç”Ÿç±»å¯è®¿é—®ï¼Œå¤–éƒ¨ä¸å¯è®¿é—®
- publicï¼šå®Œå…¨å¼€æ”¾ï¼Œæ‰€æœ‰åœ°æ–¹éƒ½å¯è®¿é—®
- friendï¼šç‰¹æ®Šæœºåˆ¶ï¼Œå…è®¸æŒ‡å®šå¤–éƒ¨è®¿é—®ç§æœ‰æˆå‘˜

### æœ€ä½³å®è·µ
1. ä¼˜å…ˆä½¿ç”¨ private ä¿æŠ¤æ•°æ®
2. è°¨æ…ä½¿ç”¨ protectedï¼Œåªåœ¨ç¡®å®éœ€è¦æ—¶ä½¿ç”¨
3. åˆç†ä½¿ç”¨ public æš´éœ²æ¥å£
4. è°¨æ…ä½¿ç”¨ friendï¼Œé¿å…ç ´åå°è£…

### ä¸€å¥è¯æ€»ç»“
- private æ˜¯"æœ€å®‰å…¨"
- protected æ˜¯"ç»™å­ç±»ç•™å£å­"
- public æ˜¯"å¯¹å¤–çš„çª—å£"
- friend æ˜¯"æŠŠé’¥åŒ™äº¤ç»™åˆ«äºº"

---

*å‚è€ƒæ–‡çŒ®ï¼š*
1. "The C++ Programming Language" by Bjarne Stroustrup
2. "Effective C++" by Scott Meyers
3. "C++ Primer" by Stanley Lippman
4. "Design Patterns" by Erich Gamma
5. "Clean Code" by Robert C. Martin 
