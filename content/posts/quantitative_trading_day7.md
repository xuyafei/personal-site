---
title: "量化交易入门指南：第7天 风险与收益建模基础完全指南"
date: 2024-05-27
draft: false
description: "深入理解金融中的风险与收益建模，包括收益率计算、风险度量、夏普比率和CAPM模型等核心概念"
tags: ["金融", "量化", "风险管理", "投资", "教程"]
categories: ["量化金融"]
author: "徐亚飞"
showToc: true
TocOpen: true
weight: 20
---

# 风险与收益建模基础完全指南

##  Part 1：什么是收益？什么是风险？

###  收益（Return）

资产价格从某个时间点变化到另一个时间点所带来的回报。常见有两种形式：

- 简单收益率：
  $$R_t = \frac{P_t - P_{t-1}}{P_{t-1}} = \frac{\Delta P}{P_{t-1}}$$

- 对数收益率（连续复利）：
  $$r_t = \ln\left(\frac{P_t}{P_{t-1}}\right)$$

 对数收益率在数学推导中更方便，且可加性好（多期收益 = 各期之和）

###  对数收益率详解

#### 一、定义

对数收益率的计算公式如下：
$$r_t = \ln\left(\frac{P_t}{P_{t-1}}\right)$$

其中：
- $r_t$：时间 t 的对数收益率
- $P_t$：时间 t 的价格
- $P_{t-1}$：时间 t-1 的价格
- $\ln$：自然对数（以 e 为底）

#### 二、为什么使用对数收益率？

| 优点 | 解释 |
|------|------|
| 1️⃣ 可以相加 | 多期的对数收益率可以直接相加：$r_{1,3} = r_{1,2} + r_{2,3}$ 这在统计和建模中很方便 |
| 2️⃣ 对称性更好 | 正收益和负收益的对称性更合理，比如涨 50% 和跌 50%，对数收益率表现更准确 |
| 3️⃣ 适合连续复利 | 假设资产是以"连续复利"方式增长（在金融建模中常见），则对数收益率就是精确的增长率 |
| 4️⃣ 更适合正态分布假设 | 对数收益率近似服从正态分布，有助于建立风险模型（如 VaR） |

#### 三、与普通收益率的关系

- 普通收益率（线性）：
  $$R_t = \frac{P_t - P_{t-1}}{P_{t-1}} = \frac{P_t}{P_{t-1}} - 1$$

- 对数收益率：
  $$r_t = \ln\left(\frac{P_t}{P_{t-1}}\right)$$

二者之间的近似关系：
$$r_t \approx R_t \quad \text{当 } R_t \text{ 较小时}$$

例如：
| 线性收益率 | 对数收益率 |
|------------|------------|
| 100 → 105 | 5% | ≈ 4.88% |
| 100 → 110 | 10% | ≈ 9.53% |
| 100 → 90 | -10% | ≈ -10.54% |

所以：
- 对数收益率 < 线性收益率（正收益时）
- 对数收益率 > 线性收益率（负收益时）

#### 四、如何理解"连续复利"？

如果我们每天收益是 r，那么连续复利增长下：

$$P_t = P_0 \cdot e^{r \cdot t}$$

即：
$$\ln\left(\frac{P_t}{P_0}\right) = r \cdot t$$

对数收益率就等价于"每单位时间的复利增长速度"。

#### 五、实际应用

在金融领域：
- 高频数据分析（分钟、秒）常用对数收益率
- 资产组合的收益建模（如 Markowitz 均值-方差模型）
- 风险度量（如波动率、VaR）
- 时间序列建模（如 GARCH）等

#### 总结一句话：

对数收益率 = 假设资产按连续复利增长时的真实增长率。
它让你可以加总收益、建模波动、贴合现实，是金融量化里的"标准利器"。

###  风险（Risk）

风险一般通过收益的波动性（即标准差、方差）来衡量：

- 方差（Variance）：
  $$\text{Var}(R) = \mathbb{E}\left[(R - \mathbb{E}[R])^2\right]$$

- 标准差（Volatility）：
  $$\sigma = \sqrt{\text{Var}(R)}$$

###  风险的本质是什么？

在投资中，风险（Risk）不是亏损，而是"不确定性"：
- 如果一项投资的回报总是一样的，比如每年稳稳地赚 6%，那几乎没有风险。
- 但如果有时赚 20%，有时亏 10%，那你每年赚多少钱就非常不确定 —— 这就是"有风险"。

###  如何用数学量化"波动"？

#### 1. 期望收益（平均值）$\mathbb{E}[R]$

表示这项投资"平均"能赚多少钱。

比如：
- 如果一个投资有 3 年的年回报分别是 5%、7%、6%
- 那它的平均收益就是 $(5\% + 7\% + 6\%) / 3 = 6\%$

我们记作：
$$\mathbb{E}[R] = 6\%$$

#### 2. 方差（Variance）

表示：每年的收益偏离平均值的程度。

$$\text{Var}(R) = \mathbb{E}[(R - \mathbb{E}[R])^2]$$

别怕这个公式，它其实在做两件事：
1. $R - \mathbb{E}[R]$：每年的收益，减去平均收益，看看偏离了多少。
2. 然后平方（防止正负抵消），再取平均数。

🔍 例子：

3 年收益分别是：5%、7%、6%，我们知道平均是 6%。

所以：
- 第一年偏差 = $5\% - 6\% = -1\%$
- 第二年偏差 = $7\% - 6\% = +1\%$
- 第三年偏差 = $6\% - 6\% = 0\%$

平方后：
- $(-1\%)^2 = 0.0001$
- $(+1\%)^2 = 0.0001$
- $(0\%)^2 = 0$

平均一下就是方差：
$$\text{Var}(R) = (0.0001 + 0.0001 + 0) / 3 = 0.0000667$$

#### 3. 标准差（Volatility）

标准差就是方差的平方根：
$$\sigma = \sqrt{\text{Var}(R)} = \sqrt{0.0000667} \approx 0.0082 = 0.82\%$$

这个数值告诉你：
📌 这项投资的年收益通常会在 ±0.82% 的区间上下波动。

###  标准差 = 波动率 = 风险指标
- 标准差越大 → 收益波动越剧烈 → 风险越高
- 标准差越小 → 收益更稳定 → 风险越低

###  总结类比：
| 指标 | 含义 | 类比 |
|------|------|------|
| 期望收益 $\mathbb{E}[R]$ | 平均你能赚多少 | 平均工资 |
| 方差 | 偏离平均收益的"力度" | 工资起伏 |
| 标准差 | 方差的平方根，更直观 | 工资波动范围 |

##  Part 2：Sharpe Ratio（夏普比率）

衡量单位风险带来的超额收益：

$$\text{Sharpe Ratio} = \frac{E[R_p - R_f]}{\sigma_p}$$

其中：
- $R_p$：投资组合年化收益率
- $R_f$：无风险收益率（如国债利率）
- $\sigma_p$：投资组合年化波动率

###  Sharpe越高 → 回报越稳健 → 风险调整后更好

###  示例：
- A策略：年化收益20%，波动率10% → Sharpe = 2
- B策略：年化收益25%，波动率20% → Sharpe = 1.25

虽然B的收益更高，但从风险收益比上看，A更优秀。

###  1. 什么是 Sharpe Ratio？

Sharpe Ratio = 超额收益 / 风险

公式如下：
$$\text{Sharpe Ratio} = \frac{R_p - R_f}{\sigma_p}$$

其中：
- $R_p$：投资组合的年化收益率（Portfolio Return）
- $R_f$：无风险利率（Risk-Free Rate），一般用国债利率代替
- $\sigma_p$：投资组合的收益率标准差（即波动率）

###  2. 各个部分的意义
| 符号 | 含义 | 解释 |
|------|------|------|
| $R_p$ | 投资的预期收益 | 你买这个资产，平均每年赚多少钱 |
| $R_f$ | 无风险收益 | 买国债啥也不干能赚多少钱 |
| $R_p - R_f$ | 超额收益（风险溢价） | 冒风险多赚的钱 |
| $\sigma_p$ | 收益的波动（风险） | 收益的"稳定性"衡量方式 |

###  3. 举个简单例子
| 项目 | A基金 | B基金 |
|------|--------|--------|
| 年化收益 $R_p$ | 10% | 15% |
| 无风险收益 $R_f$ | 3% | 3% |
| 波动率 $\sigma_p$ | 8% | 20% |

我们计算两者的 Sharpe Ratio：
- A基金：$\frac{10\% - 3\%}{8\%} = 0.875$
- B基金：$\frac{15\% - 3\%}{20\%} = 0.6$

➡️ 虽然 B 的收益更高，但 Sharpe Ratio 更低，说明 A 每承担 1 单位风险，能获得更高的回报，风险调整后更"高效"。

###  4. 为什么 Sharpe Ratio 有用？

它是一个非常直观的指标，用于判断：
"承担的风险是否值得？"

- 如果 Sharpe Ratio 很高 → 表明你承担的风险是"值得的"
- 如果 Sharpe Ratio 很低 → 冒了很大风险但没有得到相应回报

###  5. Sharpe Ratio 的标准参考值
| Sharpe Ratio | 解释 |
|--------------|------|
| < 1 | 风险回报较差 |
| = 1 ~ 1.5 | 一般 |
| = 1.5 ~ 2 | 良好 |
| > 2 | 非常优秀 |
| > 3 | 稀有，通常只有量化基金/对冲基金达到 |

###  6. 一个投资者应该怎么用它？
- 比较多个资产/基金/策略的 Sharpe Ratio，选择更"划算"的风险报酬组合
- 判断一个策略是否值钱：不是看收益高不高，而是"冒这个风险，回报划不划算"
- 适用于：基金、股票组合、ETF、量化策略等

###  7. 局限性（很重要）
- 只适用于收益分布接近正态分布的资产（而现实中常常不是）
- 假设波动率就是"风险"，但有时投资者更在意"下跌风险"
- 对于波动较小但会崩盘的策略（如某些卖期权策略），可能高估安全性

 所以有些人会用 Sortino Ratio（只考虑下行波动）来代替 Sharpe Ratio。

###  总结一张表记住：
| 指标 | 解释 | 理想值 |
|------|------|--------|
| $R_p$ | 预期收益率 | 越高越好 |
| $R_f$ | 无风险利率 | 常用国债利率 |
| $\sigma_p$ | 风险（波动） | 越低越好 |
| Sharpe Ratio | 每单位风险带来的超额回报 | 越高越好 |

##  Part 3：CAPM 模型（资本资产定价模型）

这是最基础的资产定价模型，揭示了资产预期收益和风险之间的关系。

$$E[R_i] = R_f + \beta_i (E[R_m] - R_f)$$

含义如下：
- $E[R_i]$：资产 i 的期望收益率
- $R_f$：无风险收益率
- $E[R_m]$：市场组合的预期收益率
- $\beta_i$：资产 i 相对于市场组合的风险暴露（系统性风险系数）

###  什么是 β（Beta）？

衡量资产相对市场的波动性：

$$\beta_i = \frac{\text{Cov}(R_i, R_m)}{\text{Var}(R_m)}$$

| β 值范围 | 含义 |
|----------|------|
| β = 1 | 与市场波动一致 |
| β > 1 | 比市场更敏感 → 高风险高收益 |
| β < 1 | 比市场稳定 → 低风险低收益 |

 在 CAPM 模型中，只有 β 决定了超额收益，其他非系统性风险不会获得补偿。

### 直观理解：

CAPM 给出了资产"合理收益率"的计算方式：

 一项投资的期望回报率 = 无风险利率 + 你承担的市场风险 × 市场给出的"回报补偿"

 举个例子：

假设：
- 无风险利率 $R_f = 2\%$
- 市场期望收益 $R_m = 8\%$
- 某股票的 Beta $\beta = 1.5$

则该股票的合理期望收益：
$$R_i = 2\% + 1.5 \times (8\% - 2\%) = 11\%$$

 这告诉你：如果某股票的预期收益少于 11%，就"不划算" —— 风险太大但补偿太少。

##  Part 4：Alpha 与残差收益

Alpha（α） 是实际收益与 CAPM 模型预测收益之间的差：

$$\alpha = R_i - [R_f + \beta_i (R_m - R_f)]$$

- 若 α > 0，说明资产表现优于模型预测 → "阿尔法策略"核心思想
- 在量化中，Alpha 是投资者想要"捕捉"的信号来源

### 定义：

$$\alpha = \text{实际收益} - \text{CAPM模型预测收益}$$

- CAPM 是"你应该拿到"的收益
- Alpha 是"你实际拿到"的与之差额

### 理解：
| Alpha 值 | 含义 |
|----------|------|
| α > 0 | 你超额赚钱了，可能是选股能力强 |
| α = 0 | 完全跟着市场跑 |
| α < 0 | 你不但没赚钱，还拖市场后腿 |

 Alpha 可以用来评估：
- 基金经理有没有选股能力
- 你的策略是不是能"战胜市场"
- CAPM 模型解释得有多"充分"

###  总结这三者关系
| 概念 | 解释 | 数学意义 |
|------|------|----------|
| Beta | 股票对市场的敏感性 | $\beta = \frac{\text{Cov}(R_i, R_m)}{\text{Var}(R_m)}$ |
| CAPM | 你应得的合理收益 | $R_i = R_f + \beta(R_m - R_f)$ |
| Alpha | 你实际赚的钱 vs 你应得的收益 | $\alpha = R_\text{实际} - R_\text{CAPM}$ |

###  用个例子串联起来：

你买入一只基金，年末赚了 15%。我们来算它的 Alpha：
- 无风险利率 $R_f = 2\%$
- 市场涨了 $R_m = 10\%$
- 基金 Beta = 1.2
- 实际收益：15%

CAPM 预测收益：
$$R_\text{CAPM} = 2\% + 1.2 \times (10\% - 2\%) = 11.6\%$$

Alpha：
$$\alpha = 15\% - 11.6\% = 3.4\%$$

 意思是：你超额获得了 3.4% 的收益，说明基金经理确实有能力挑中好标的。

## 课后练习

###  课后练习 1

题目回顾：

你有两只资产：
- 资产 A：年化收益 15%，年化波动率 10%
- 资产 B：年化收益 18%，年化波动率 20%
- 无风险利率为 3%

试比较这两个资产的 Sharpe 比率。

解题思路：

Sharpe 比率的公式为：
$$\text{Sharpe Ratio} = \frac{E[R_p - R_f]}{\sigma_p}$$

其中：
- $E[R_p]$：资产年化收益
- $R_f$：无风险收益率（题中为 3%）
- $\sigma_p$：资产的年化波动率（标准差）

计算资产 A 的 Sharpe 比率：
$$\text{Sharpe}_A = \frac{15\% - 3\%}{10\%} = \frac{12\%}{10\%} = 1.2$$

计算资产 B 的 Sharpe 比率：
$$\text{Sharpe}_B = \frac{18\% - 3\%}{20\%} = \frac{15\%}{20\%} = 0.75$$

 结论：

虽然资产 B 的年化收益更高，但它的波动率也更大，因此 风险调整后的收益更差。
所以从 Sharpe 比率角度来看，资产 A 更优。

###  课后练习 2

题目回顾：

某资产的 Beta 为 1.2，市场组合的年化收益率为 10%，无风险利率为 3%。
请按照 CAPM 模型，计算该资产的预期年化收益率。

解题思路：

CAPM 模型的公式如下：
$$E[R_i] = R_f + \beta_i \cdot (E[R_m] - R_f)$$

代入数值：
- $R_f = 3\%$
- $\beta_i = 1.2$
- $E[R_m] = 10\%$

计算过程：
$$E[R_i] = 3\% + 1.2 \cdot (10\% - 3\%) = 3\% + 1.2 \cdot 7\% = 3\% + 8.4\% = 11.4\%$$

 结论：

该资产的预期年化收益率为 11.4%。
说明因为它的 Beta 大于 1（对市场更敏感），所以市场涨时预期收益更高。

## 总结

本文全面介绍了金融中的风险与收益建模基础，主要包含以下核心内容：

1. **收益计算**
   - 详细讲解了简单收益率和对数收益率
   - 分析了各自的特点和应用场景
   - 提供了清晰的计算方法

2. **风险度量**
   - 深入分析了风险的本质
   - 介绍了方差和标准差的计算
   - 总结了风险度量的实际应用

3. **风险调整收益**
   - 详细介绍了夏普比率
   - 分析了其优缺点和局限性
   - 提供了实际应用案例

4. **资产定价模型**
   - 讲解了CAPM模型
   - 介绍了Beta和Alpha的概念
   - 提供了实际计算示例

通过本文的学习，读者可以：
- 深入理解金融中的风险与收益
- 掌握风险度量和收益计算的方法
- 学会使用现代金融工具进行投资分析
- 建立科学的投资决策框架

希望这篇文章能帮助读者更好地理解和运用金融中的风险与收益建模，做出更明智的投资决策。 
